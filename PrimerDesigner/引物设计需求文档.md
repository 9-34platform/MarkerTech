# 引物设计需求描述

为本站基因分型技术提供配套的引物设计服务。对于该项服务，详细要求如下：

1. 使用者能够通过输入不同的参数来选择不同基因分型方案的引物设计服务

2. 使用者需要输入指定格式的 FASTA 文本文件以进行批量引物设计（详见[**示例文件**](# 示例文件)）

2. 对于每条序列进行引物设计时，仅挑选一对打分最高的引物作为该序列的结果返回

3. 使用者需要输入引物长度、产物长度和 Tm 值以约束引物设计结果

   > 其余约束参数（详见开发文档）在程序内部设置，以保证最佳的引物设计效果，使用者无权访问和修改

4. 引物设计的返回信息应包括项目名称、引物序列、引物 5' 位置、引物长度、引物 Tm 值、引物 GC 含量和扩增子长度，这些信息以 Excel 表格文件的形式输出（详见[**预期输出**](# 预期输出)）

不同于常规引物设计，本站设计的引物由于在右引物 5' 端前加上了额外的特定序列，建议仅用于本站提供的基因分型技术。

## 示例文件

输入的文本文件采用生物信息学中的 FASTA 格式，并将其中每个描述行和对应的序列作为一份引物设计的输入

- **描述文本** 
  - 序列对应的描述文本是指从描述行 `>` 后的第一个字符至行末的内容，仅允许单行输入
  - 本数据库所用 FASTA 文件的描述文本应包含用于标注识别的序列名称和模板序列上的保留区间这两部分
  - 序列名称与保留区间之间以管道符 `|` 分隔
  - 保留区间左闭右闭，且端点值均为模板序列上的位置，以 `-` 分隔（若保留区间的长度仅为一个碱基，则仅注明该位点位置，而无需写为区间形式）
  - 保留区间不宜太长，以确保引物设计过程中有更多的选择
  - 描述行内为提高文本可读性而添加的空格不影响程序的识别
- **序列信息** 
  - 序列信息是指从当前 `>` 符号到下一个 `>` 符号之间的内容，允许单行或多行输入
  - 序列信息应为 DNA 序列，字母全部大写，不应掺杂除换行符以外的其余任何字符
  - 模板序列上的位置从 `1` 开始
  - 模板序列的长度最短不能低于 150bp，推荐输入保留区间两侧各 `300bp` 的序列

具体示例如下：

~~~txt
>marker1|301
TTTGCCACTTAAACGTTGGCTCCTTGACTGTGTCATGTGTCCATGTGTGTCGATTCTGAA
AGATTCCTTCTCCTTGGGTGTTCAGTTTCTTGATTGATGAAAATTGCCTGGCTAACTAAT
CTGTGTTTCCTCGCCAGGCAATTGCGCTCTGCCCCGACGTCGCCGTCTACTGGATCAATC
GGGCCCTGTGCCATTTCAAGCGCAAGTGAGCGACTTTACTTTTTGTTGCCTCCCTTCCTG
GCAAGAAAGAAACAAACGTCTGGAATAGTAATCTTTGTGCACAGGGAGTGGGCCAAGGTC
GAAGAGGACAGCAGGAGGGCTCTTGCGCTTGATTACACTTTAGTCAAGGTCACATTCTTG
TTTCTTCTTTCGTCTCAAAACTAAAGCGCCGACTTCAGTTACCTCTACATTATGTAATCG
CTATTCTTAACTAACCGTTTGACACCAATAAAGATACAAAAGTAAGTAGCCGTGATTATT
CCGTTCCTTGTGTGATGTAGGGGCACTATCTGCTGGGGTGTGCGCTACTCGAGAAGGAAG
AATCTGCTCTTGCTATCAAGGAATTCGAAAAGGTTTACCTCAACCGTTTGTCTCTTGCAC
G
>marker2|301-304
TGCTCGGATGTGACTGAGTGACGACGATCACGGTGCAGTTTCTTGTCAATTCTTCGGGTCGAATGCTCGCAGCAGACGACTGAGGCCGTGATCAAGCGGTGGACGACGGTGACGGAGATCATAGGGAAGGCCATGGTCGCCATGCGGAGGCAGCTGTACGCGCAGAACCCAGGCGCCTTCGACGGTTTCAGGGACGAATACTTGCTGGCCATCGCGGAGAACCGCATCCTGATCCTGCTCGACTTCGCCAACGGATTCACCAGCATCACGTCGCACGAGAAGCTCGTGTACATGCTCGGCATGTACGAGGCTCTCACCGACGCCGCTCCCAGCCTCCTGCTCCTCCTCAGCGGCGCGCGCAAGGAGGCCATCTCGGAGCGGACACAAGGTATCCTCACGAAACTGGCCGGCGCGGTGAGGATCATGGTCAGCGGCGCCATAGCCAAGATCCAAGGCGACTCACTGTTCCCGCACACGCCGAGCGCCGCAGGTGGCGTCCACCCGCTGACACGCAACGCCATGACCTGCGTCGAGCTGCTGGCGAGGCACCGCACCACGCTCGATCTGATCCTCGCGGGCGCCGACGAGCGCAGCTCCCTCGCC
> marker3 | 348-348
ATTATATCCCAAGTGAACCTAAAAGTTCTCCCACACAACGACGCAGGGTTTTACAAACAACCACCAAGGGCATGTTGTGGCGCGCCTGGGAGGGGTCCTTACAATTTCAACCTGACAGCGAAGTGCGGTGAGCCTGGTGCCTCGGCTTGCGCTGATCCTAAGACGCACTGGAGCTGGGATGGTATTCACTTGACAGAAGCCGCGTATCTGCACATTGCCAGAGGCTGGCTTCATGGACCGTTCGCAGACCAGCCTGTTGTACAAGCATCTTGAGTAATGTTGTGGCGCGCCTGGGAGGGGTCCTTACAATTTCAACCTGACAGCGAAGTGCGGTGAGCCTGGTGCCTCGGCTTGCGCTGATCCTAAGACGCACTGGAGCTGGGATGGTATTCACTTGACAGAAGCCGCGTATCTGCACATTGCCAGAGGCTGGCTTCATGGACCGTTCGCAGACCAGCCTGTTGTACAAGAGGGCATGTTGTGGCGCGCCTGGGAGGGGTCCTTACAATTTCAACCTGACAGCGAAGTGCGGTGAGCCTGGTGCCTCGGCTTGCGCTGATCCTAAGACGCACTGGAGCTGGGATGGTATTCACTTGATGAGTACAGTACACCCAGCCTCTCCTCCCTGCTGTTCTTGCACCTCTAGAGTGAGTGGCCACAATAGCACACACCGTGCGTGACACCAAACTGGATCCGATAAGGTA
~~~

## 预期输出

引物设计的输出表格中，除表头外的每行均表示一项引物设计结果，每项结果均包含 12 项属性

- 第 1 列为设计结果的项目名称，与模板序列名称相同
- 第 2 - 11 列为左右引物的相关属性，除后引物序列外，其余各项属性的计算均未考虑附加序列：
  - 第 2, 3 列分别为左右引物的序列，从左到右方向均为 5'->3' ，且右引物前添加了特定的附加序列
  - 第 4, 5 列分别为左右引物 5' 端在参考序列上的位置
  - 第 6, 7 列分别为左右引物的长度
  - 第 8, 9 列分别为左右引物的退火温度
  - 第 10, 11 列分别为左右引物的 GC 含量
- 第 12 列为扩增子长度

输出格式如下表所示：

|  Name   | Seq (L) | Seq (R) | 5'pos (L) | 5'pos (R) | Len (L) | Len (R) | Tm (L) | Tm (R) | GC (L) | GC (R) | Product Size |
| :-----: | :-----: | :-----: | :-------: | :-------: | :-----: | :-----: | :----: | :----: | :----: | :----: | :----------: |
| marker1 |         |   ...   |           |           |         |         |        |        |        |        |              |
| marker2 |         |   ...   |           |           |         |         |        |        |        |        |              |
| maker3  |         |   ...   |           |           |         |         |        |        |        |        |              |



