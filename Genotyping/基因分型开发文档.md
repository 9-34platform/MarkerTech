~~~mermaid
flowchart TB
    
    %% Definition of style class
    classDef endPoint fill:#FFFCED,stroke:#B3AA82,stroke-width:2px
    classDef startPoint stroke-width:2px
    
    %% Subgraph of primer design
    subgraph PrimerDesign
    PDpy([PrimerDesigner.py])
    end
    %% Subgraph of sequence analysis
    subgraph SeqAnalysis
    Fastp(Fastp) --> clean.fq
    clean.fq --> BFpy([BarcodeFilter.py]) --> sampleFq[[samples.fq]]
    %% Flow of samples.fq
    sampleFq --> BWA(BWA) --> SAMtools(SAMtools) --> sampleBam[[samples.sorted.bam]]
    sampleFq --> MCpy([MarkerCount.py])
    %% Flow of samples.sorted.bam
    sampleBam --> MCpy --> Mcsv[[markers.csv]] --> Mpy([Minima.py])
    end
    
    %% Primer design
    PDservice((PrimerDesign<br>Service)):::startPoint --> template.fa
    template.fa --> PDpy --> primers.xlsx
    %% Wet experiment
    primers.xlsx -.Amplicon<br>Sequencing.-> fastq.fq --> Fastp
    %% Sequence analysis
    SAservice((SeqAnalysis<br>Service)):::startPoint --> fastq.fq
    SAservice:::startPoint --> barcode.txt
    SAservice:::startPoint --> mutation.csv
    SAservice:::startPoint -.Optional.-> RefSeq[(Reference)]
    
    %% Flow of user inputs
    barcode.txt --> BFpy
    barcode.txt --> MCpy
    mutation.csv --> MCpy
    RefSeq --> BWA
    
    Mpy --> Mpng[[markers.png]] -.genotyping.-> Mxlsx[[markers.xlsx]]
    Mpy --> Mxlsx --> result((Genotype)):::endPoint
~~~

